webpackJsonp([54979964081745],{777:function(e,t){e.exports={data:{post:{id:"/media/duthaho/New Volume/learn/github/duthaho-blog/content/posts/2019-05-26--react-component-lifecycle-2/index.md absPath of file >>> MarkdownRemark",html:'<p>Trở lại với serial <code class="language-text">tìm hiểu về vòng đời của React 16+ component</code>, phần này chúng ta sẽ lần lượt tìm hiểu về giai đoạn <code class="language-text">updating</code> (re-render).\nỞ phần trước, chúng ta đã biết <em>vòng đời của 1 component là gì?</em> và các giai đoạn của nó?. Bạn nào chưa đọc thì xem <a href="https://duthaho.com/blogs/react-component-lifecycle">phần 1</a> trước nhé!</p>\n<h3>The updating</h3>\n<p>Sau khi component được mount trên browser, nếu <code class="language-text">props</code> hay <code class="language-text">state</code> của nó thay đổi, hoặc lúc ta gọi <code class="language-text">forceUpdate</code>, lúc này component sẽ được vẽ lại (re-rendered), hay nói cách khác, component được update, lúc này component chuyển qua giai đoạn <code class="language-text">updating</code>.</p>\n<p>Sau đây là những hàm được gọi trong quá trình <code class="language-text">updating</code>?</p>\n<h4>1. static getDerivedStateFromProps()</h4>\n<p>Bạn có thấy hàm này quen không? Vâng, chúng ta đã tìm hiểu nó ở phần 1, và tiếp tục, đây là hàm đầu tiên được gọi trong quá trình <code class="language-text">updating</code>. Mình không giải thích thêm ở đây, đọc phần trước để hiểu nhé!</p>\n<h4>2. shouldComponentUpdate()</h4>\n<p>Ngay sau khi hàm  <code class="language-text">static getDerivedStateFromProps</code>  được gọi, hàm  <code class="language-text">shouldComponentUpdate</code>  sẽ được réo tên.</p>\n<p>Mặc định thì component sẽ được re-render khi <code class="language-text">props</code> hoặc <code class="language-text">state</code> thay đổi, nhưng có lúc nào bạn nghĩ sẽ không cho nó update không? Đó chính là lúc bạn cần đến hàm này.</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*xpOue2D_CdBdQL2-MmoD8Q.png"></p>\n<p>Ở hàm này bạn sẽ trả về một giá trị boolean — <code class="language-text">true</code>  hoặc  <code class="language-text">false</code>, nếu <code class="language-text">true</code> thì component sẽ render (mặc định sẽ return <code class="language-text">true</code>), ngược lại nếu <code class="language-text">false</code> thì sẽ ngăn quá trình re-render.</p>\n<p>Thật sự thì component sẽ re-render nếu component cha của nó được re-render dù cho <code class="language-text">state</code> hay <code class="language-text">props</code> của component con có thay đổi hay không. Vậy để xử lý trường hợp này, React đã giới thiệu <a href="https://reactjs.org/docs/react-api.html#reactpurecomponent">PureComponent</a> được dùng trong trường hợp bạn không muốn component con re-render nếu  <code class="language-text">state</code> hoặc  <code class="language-text">props</code>  của nó không thay đổi.</p>\n<h4>3. render()</h4>\n<p>Sau khi gọi  <code class="language-text">shouldComponentUpdate</code>,  <code class="language-text">render</code>  là hàm tiếp theo được gọi để thực hiện việc re-render - tất nhiên là nó phải phụ thuộc vào kết quả trả về của hàm <code class="language-text">shouldComponentUpdate</code>.</p>\n<h4>4. getSnapshotBeforeUpdate()</h4>\n<p>Hàm tiếp theo trong quá trình <code class="language-text">updating</code> là <code class="language-text">getSnapshotBeforeUpdate</code>.</p>\n<p>Hàm này mới được React16+ thêm vào. Hơi khó để giải thích nhưng mình sẽ cố :cry: Có thể mình sẽ ít dùng hàm này, nhưng nó được dùng trong 1 số trường hợp nhất định. Đặc biệt là khi chúng ta muốn lấy thông tin DOM element và cập nhật chúng sau khi <code class="language-text">updating</code> xong.</p>\n<p>Có thể bạn thấy vô cmn lý là hàm này được gọi sau khi <code class="language-text">render</code>, thì lúc truy cập DOM element ở hàm này thì giá trị của DOM là giá trị sau khi <code class="language-text">updating</code>. Nhưng không, đây là <strong>1 chú ý quan trọng</strong>, giá trị DOM được truy cập ở hàm <code class="language-text">getSnapshotBeforeUpdate</code> sẽ là giá trị trước khi được <code class="language-text">update</code>, mặc dù nó được gọi sau hàm <code class="language-text">render</code>.</p>\n<blockquote>\n<p>Quá trình DOM <code class="language-text">updating</code> được xảy ra bất đồng bộ (asynchronus) nhưng chắc chắn 1 điều là hàm <code class="language-text">getSnapshotBeforeUpdate</code> sẽ được gọi trước khi DOM được updated.</p>\n</blockquote>\n<p>Code thử xem nào, nói cm gì cho dài dòng. Chắc hẳn bạn đã từng sử dụng 1 ứng dụng chat bất kỳ, và khi có tin nhắn mới thì nó sẽ scroll xuống tin nhắn mới dưới cùng, đúng không? Hãy thử implement <code class="language-text">Chat</code> list và handle tính năng trên nhé!</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*mjRyC6lSmhq38vEhgYThJw.png"></p>\n<p>Thêm <code class="language-text">Chats</code>  component vào <code class="language-text">App</code>:</p>\n<div class="gatsby-highlight" data-language="javascript">\n      <pre class="language-javascript"><code class="language-javascript"><span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">"chat-thread"</span><span class="token operator">></span>\n\t<span class="token operator">&lt;</span>Chats chatList<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>chatList<span class="token punctuation">}</span> <span class="token operator">/</span><span class="token operator">></span>\n<span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></code></pre>\n      </div>\n<p><code class="language-text">Chats</code> component nhận vào 1 mảng các tin nhắn và hiển thị:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token keyword">class</span> <span class="token class-name">Chats</span> <span class="token keyword">extends</span> <span class="token class-name">Component</span> <span class="token punctuation">{</span>\n\t<span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token keyword">return</span> <span class="token punctuation">(</span>\n\t\t\t<span class="token operator">&lt;</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>\n\t\t\t\t<span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span><span class="token function">map</span><span class="token punctuation">(</span><span class="token punctuation">(</span><span class="token parameter">chat<span class="token punctuation">,</span> i</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">(</span>\n\t\t\t\t\t<span class="token operator">&lt;</span>li key<span class="token operator">=</span><span class="token punctuation">{</span>i<span class="token punctuation">}</span> className<span class="token operator">=</span><span class="token string">"chat-bubble"</span><span class="token operator">></span>\n\t\t\t\t\t\t<span class="token punctuation">{</span>chat<span class="token punctuation">}</span>\n\t\t\t\t\t<span class="token operator">&lt;</span><span class="token operator">/</span>li<span class="token operator">></span>\n\t\t\t\t<span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">}</span>\n\t\t\t<span class="token operator">&lt;</span><span class="token operator">/</span>React<span class="token punctuation">.</span>Fragment<span class="token operator">></span>\n\t\t<span class="token punctuation">)</span><span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Khi click button <code class="language-text">Add Chat</code> thì sẽ thêm <em>Hello!!!</em> vào mảng <code class="language-text">chatList</code>.</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function-variable function">_handleAddChat</span> <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=></span> <span class="token punctuation">{</span>\n\t<span class="token keyword">this</span><span class="token punctuation">.</span><span class="token function">setState</span><span class="token punctuation">(</span><span class="token parameter">prevState</span> <span class="token operator">=></span> <span class="token punctuation">(</span><span class="token punctuation">{</span>\n\t\tchatList<span class="token punctuation">:</span> <span class="token punctuation">[</span><span class="token operator">...</span>prevState<span class="token punctuation">.</span>chatList<span class="token punctuation">,</span> <span class="token string">"Hello!!!"</span><span class="token punctuation">]</span>\n\t<span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">)</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span><span class="token punctuation">;</span></code></pre>\n      </div>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*B4cllvTOFasbw6pasGk4AQ.png"></p>\n<p>Kết quả như sau:</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*t7cLFKAjuAIstmDwZdSIYQ.gif"></p>\n<p>Hẳn bạn đã nhận ra vấn đề? <code class="language-text">Chats</code> component không tự động scroll xuống tin nhắn mới. Cái mà chúng ta muốn là kết quả dưới đây:</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*T8NI8_od1UIBJPbmsRVS_Q.gif"></p>\n<p>Hãy xem hàm  <code class="language-text">getSnapshotBeforeUpdate</code> sẽ giúp chúng ta giải quyết vấn đề này như thế nào?..</p>\n<p>Đây là cú pháp của hàm <code class="language-text">getSnapshotBeforeUpdate</code>, nó nhận vào 2 tham số, <code class="language-text">prevProps</code> và <code class="language-text">prevState</code>:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>   <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Và nhận kết quả trả về là một giá trị nào đó hoặc <code class="language-text">null</code>:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">return</span> value <span class="token operator">||</span> <span class="token keyword">null</span> <span class="token comment">// value ở đây là một giá trị nào đó</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Tất nhiên là hàm nào cũng có mục đích của nó, và hàm này không tự hoạt động 1 cách riêng lẽ, <code class="language-text">value</code> trả về ở đây sẽ được truyền vào 1 hàm lifecycle khác là <code class="language-text">componentDidUpdate</code>, sẽ được mình trình bày bên dưới. Tạm gác vấn đề <code class="language-text">Chats</code> list ở đây để xem <code class="language-text">componentDidUpdate</code> là cái khỉ gì đã nhé.</p>\n<h4>5. componentDidUpdate()</h4>\n<p>Như đã tiết lộ, hàm này sẽ được gọi sau <code class="language-text">getSnapshotBeforeUpdate</code>. Và tham số của nó cũng giống như <code class="language-text">getSnapshotBeforeUpdate</code>:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Chú lại xạo lol anh rồi, bên trên đã nói <code class="language-text">value</code> từ <code class="language-text">getSnapshotBeforeUpdate</code> được truyền xún hàm <code class="language-text">componentDidUpdate</code> rồi còn gì. À đó là trường hợp phổ biến, còn nếu bạn dùng chung với <code class="language-text">getSnapshotBeforeUpdate</code> thì có thêm tham số thứ ba (snapshot), chính là <code class="language-text">value</code> được truyền đến:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span> <span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Đi vào giải quyết vấn đề thôi :smiley: Thêm code sau vào <code class="language-text">App</code> component:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length <span class="token operator">></span> prevState<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token keyword">const</span> chatThreadRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chatThreadRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n\t\t<span class="token keyword">return</span> chatThreadRef<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> chatThreadRef<span class="token punctuation">.</span>scrollTop<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">return</span> <span class="token keyword">null</span><span class="token punctuation">;</span>\n<span class="token punctuation">}</span>\n\n<span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token keyword">const</span> chatThreadRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chatThreadRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n\t\tchatThreadRef<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> chatThreadRef<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> snapshot<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Code dell hiểu cái quần què gì cả, giải thích xem nào:</p>\n<p>Mình có sử dùng <strong>React Ref</strong> để xử lý với DOM, bạn có thể tìm hiểu tại <a href="https://reactjs.org/docs/refs-and-the-dom.html">đây</a>. Ở đây, DOM element mình muốn xử lý là thẻ <code class="language-text">ul</code> bao bọc <code class="language-text">Chats</code> list component:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token operator">&lt;</span>ul className<span class="token operator">=</span><span class="token string">"chat-thread"</span> ref<span class="token operator">=</span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>chatThreadRef<span class="token punctuation">}</span><span class="token operator">></span>   <span class="token operator">...</span><span class="token operator">&lt;</span><span class="token operator">/</span>ul<span class="token operator">></span></code></pre>\n      </div>\n<p>Mình chỉ muốn scroll khi có tin nhắn mới chứ không phải lúc nào cũng vậy, thế nên phải thêm điều kiện để kiểm tra có tin nhắn mới hay không?</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length <span class="token operator">></span> prevState<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token comment">// write logic here</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Nếu có tin nhắn mới, <code class="language-text">getSnapshotBeforeUpdate</code> sẽ trả về một <code class="language-text">value</code> nào đó. Không thì trả về <code class="language-text">null</code>:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">getSnapshotBeforeUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span><span class="token keyword">this</span><span class="token punctuation">.</span>state<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length <span class="token operator">></span> prevState<span class="token punctuation">.</span>chatList<span class="token punctuation">.</span>length<span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token comment">// write logic here</span>\n\t<span class="token punctuation">}</span>\n\t<span class="token keyword">return</span> <span class="token keyword">null</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Hình bên dưới mô tả về <code class="language-text">scrollTop</code> và <code class="language-text">scrollHeight</code> được dùng để tính toán cho scroll.</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*iSwbToUuE4Cj1cE_s1Jf6A.png"></p>\n<p>Ban đầu, <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight">scrollHeight</a>  sẽ là chiều cao của <code class="language-text">Chats</code> panel — trước khi tin nhắn mới được thêm vào DOM, scrollTop sẽ = 0, và giá trị trả về của hàm <code class="language-text">getSnapshotBeforeUpdate</code> sẽ là <code class="language-text">chatThreadRef.scrollHeight - 0</code>.</p>\n<p>Giá trị này sẽ được chuyển đến <code class="language-text">componentDidUpdate</code>:</p>\n<div class="gatsby-highlight" data-language="js">\n      <pre class="language-js"><code class="language-js"><span class="token function">componentDidUpdate</span><span class="token punctuation">(</span><span class="token parameter">prevProps<span class="token punctuation">,</span> prevState<span class="token punctuation">,</span> snapshot</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t<span class="token keyword">if</span> <span class="token punctuation">(</span>snapshot <span class="token operator">!==</span> <span class="token keyword">null</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>\n\t\t<span class="token keyword">const</span> chatThreadRef <span class="token operator">=</span> <span class="token keyword">this</span><span class="token punctuation">.</span>chatThreadRef<span class="token punctuation">.</span>current<span class="token punctuation">;</span>\n\t\tchatThreadRef<span class="token punctuation">.</span>scrollTop <span class="token operator">=</span> chatThreadRef<span class="token punctuation">.</span>scrollHeight <span class="token operator">-</span> snapshot<span class="token punctuation">;</span>\n\t<span class="token punctuation">}</span>\n<span class="token punctuation">}</span></code></pre>\n      </div>\n<p>Chúng ta sẽ tính toán lại <a href="https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop">scrollTop</a>, dựa theo giá trị truyền vào: <code class="language-text">chatThreadRef.scrollHeight - snapshot;</code>.</p>\n<p>Hãy nhìn hình dưới đây để dể hình dung, giá trị <code class="language-text">snapshot</code> chính là <code class="language-text">scrollHeight</code> trước khi DOM updated (previous scrollHeight), còn <code class="language-text">chatThreadRef.scollHeight</code> chính là <code class="language-text">scrollHeight</code> sau khi DOM updated (updated scrollHeight), vì thế khoảng cách (difference) chính là giá trị chúng ta cần scroll.</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*8uQmkLjLXpzbZQN8JJ71UQ.png"></p>\n<p>Set lại <code class="language-text">scrollTop</code> theo <code class="language-text">difference</code>.</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*k2dioTIozf78at5G_G4_jg.png"></p>\n<p>Và những gì chúng ta mong đợi.</p>\n<p><img src="https://cdn-images-1.medium.com/max/800/1*3DDset-1uLpUeQfvALluZQ.png"></p>\n<p>Nếu vẫn còn chưa hiểu thì bạn hãy comment bên dưới nhé. Phần 2 chắc phải dừng lại ở đây. Đón xem phần 3 cũng là phần cuối ở vài viết sau nhé. Chúng ta sẽ tìm hiểu về 2 quá trình còn lại của React component.</p>\n<p>Chào thân ái và quyết thắng!</p>',htmlAst:{type:"root",children:[{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Trở lại với serial "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"tìm hiểu về vòng đời của React 16+ component"}]},{type:"text",value:", phần này chúng ta sẽ lần lượt tìm hiểu về giai đoạn "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:" (re-render).\nỞ phần trước, chúng ta đã biết "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"vòng đời của 1 component là gì?"}]},{type:"text",value:" và các giai đoạn của nó?. Bạn nào chưa đọc thì xem "},{type:"element",tagName:"a",properties:{href:"https://duthaho.com/blogs/react-component-lifecycle"},children:[{type:"text",value:"phần 1"}]},{type:"text",value:" trước nhé!"}]},{type:"text",value:"\n"},{type:"element",tagName:"h3",properties:{},children:[{type:"text",value:"The updating"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Sau khi component được mount trên browser, nếu "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"props"}]},{type:"text",value:" hay "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"state"}]},{type:"text",value:" của nó thay đổi, hoặc lúc ta gọi "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"forceUpdate"}]},{type:"text",value:", lúc này component sẽ được vẽ lại (re-rendered), hay nói cách khác, component được update, lúc này component chuyển qua giai đoạn "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Sau đây là những hàm được gọi trong quá trình "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:"?"}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{},children:[{type:"text",value:"1. static getDerivedStateFromProps()"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Bạn có thấy hàm này quen không? Vâng, chúng ta đã tìm hiểu nó ở phần 1, và tiếp tục, đây là hàm đầu tiên được gọi trong quá trình "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:". Mình không giải thích thêm ở đây, đọc phần trước để hiểu nhé!"}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{},children:[{type:"text",value:"2. shouldComponentUpdate()"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Ngay sau khi hàm  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"static getDerivedStateFromProps"}]},{type:"text",value:"  được gọi, hàm  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"shouldComponentUpdate"}]},{type:"text",value:"  sẽ được réo tên."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Mặc định thì component sẽ được re-render khi "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"props"}]},{type:"text",value:" hoặc "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"state"}]},{type:"text",value:" thay đổi, nhưng có lúc nào bạn nghĩ sẽ không cho nó update không? Đó chính là lúc bạn cần đến hàm này."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*xpOue2D_CdBdQL2-MmoD8Q.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Ở hàm này bạn sẽ trả về một giá trị boolean — "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"true"}]},{type:"text",value:"  hoặc  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"false"}]},{type:"text",value:", nếu "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"true"}]},{type:"text",value:" thì component sẽ render (mặc định sẽ return "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"true"}]},{type:"text",value:"), ngược lại nếu "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"false"}]},{type:"text",value:" thì sẽ ngăn quá trình re-render."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Thật sự thì component sẽ re-render nếu component cha của nó được re-render dù cho "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"state"}]},{type:"text",value:" hay "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"props"}]},{type:"text",value:" của component con có thay đổi hay không. Vậy để xử lý trường hợp này, React đã giới thiệu "},{type:"element",tagName:"a",properties:{href:"https://reactjs.org/docs/react-api.html#reactpurecomponent"},children:[{type:"text",value:"PureComponent"}]},{type:"text",value:" được dùng trong trường hợp bạn không muốn component con re-render nếu  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"state"}]},{type:"text",value:" hoặc  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"props"}]},{type:"text",value:"  của nó không thay đổi."}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{},children:[{type:"text",value:"3. render()"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Sau khi gọi  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"shouldComponentUpdate"}]},{type:"text",value:",  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"render"}]},{type:"text",value:"  là hàm tiếp theo được gọi để thực hiện việc re-render - tất nhiên là nó phải phụ thuộc vào kết quả trả về của hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"shouldComponentUpdate"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{},children:[{type:"text",value:"4. getSnapshotBeforeUpdate()"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hàm tiếp theo trong quá trình "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:" là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hàm này mới được React16+ thêm vào. Hơi khó để giải thích nhưng mình sẽ cố :cry: Có thể mình sẽ ít dùng hàm này, nhưng nó được dùng trong 1 số trường hợp nhất định. Đặc biệt là khi chúng ta muốn lấy thông tin DOM element và cập nhật chúng sau khi "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:" xong."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Có thể bạn thấy vô cmn lý là hàm này được gọi sau khi "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"render"}]},{type:"text",value:", thì lúc truy cập DOM element ở hàm này thì giá trị của DOM là giá trị sau khi "
},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:". Nhưng không, đây là "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"1 chú ý quan trọng"}]},{type:"text",value:", giá trị DOM được truy cập ở hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" sẽ là giá trị trước khi được "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"update"}]},{type:"text",value:", mặc dù nó được gọi sau hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"render"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"blockquote",properties:{},children:[{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Quá trình DOM "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"updating"}]},{type:"text",value:" được xảy ra bất đồng bộ (asynchronus) nhưng chắc chắn 1 điều là hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" sẽ được gọi trước khi DOM được updated."}]},{type:"text",value:"\n"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Code thử xem nào, nói cm gì cho dài dòng. Chắc hẳn bạn đã từng sử dụng 1 ứng dụng chat bất kỳ, và khi có tin nhắn mới thì nó sẽ scroll xuống tin nhắn mới dưới cùng, đúng không? Hãy thử implement "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chat"}]},{type:"text",value:" list và handle tính năng trên nhé!"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*mjRyC6lSmhq38vEhgYThJw.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Thêm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:"  component vào "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"App"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"javascript"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"code",properties:{className:["language-javascript"]},children:[{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"text",value:"ul className"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"chat-thread"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"text",value:"Chats chatList"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"state"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"ul"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" component nhận vào 1 mảng các tin nhắn và hiển thị:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"class"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"extends"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","class-name"]},children:[{type:"text",value:"Component"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"render"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"\n\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"text",value:"React"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Fragment"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n\t\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"props"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"map"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"chat"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" i"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=>"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"\n\t\t\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"text",value:"li key"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"i"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:" className"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"chat-bubble"'}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n\t\t\t\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"chat"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\t\t\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"li"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n\t\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\t\t\t"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"React"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"Fragment"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Khi click button "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Add Chat"}]},{type:"text",value:" thì sẽ thêm "},{type:"element",tagName:"em",properties:{},children:[{type:"text",value:"Hello!!!"}]},{type:"text",value:" vào mảng "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"chatList"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function-variable","function"]},children:[{type:"text",value:"_handleAddChat"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=>"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"setState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevState"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"=>"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\tchatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:":"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"["}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"text",value:"prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"Hello!!!"'}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"]"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*B4cllvTOFasbw6pasGk4AQ.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Kết quả như sau:"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*t7cLFKAjuAIstmDwZdSIYQ.gif"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hẳn bạn đã nhận ra vấn đề? "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" component không tự động scroll xuống tin nhắn mới. Cái mà chúng ta muốn là kết quả dưới đây:"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*T8NI8_od1UIBJPbmsRVS_Q.gif"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hãy xem hàm  "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" sẽ giúp chúng ta giải quyết vấn đề này như thế nào?.."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Đây là cú pháp của hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:", nó nhận vào 2 tham số, "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"prevProps"}]},{type:"text",value:" và "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"prevState"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"   "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Và nhận kết quả trả về là một giá trị nào đó hoặc "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"null"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" value "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"||"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"null"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// value ở đây là một giá trị nào đó"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Tất nhiên là hàm nào cũng có mục đích của nó, và hàm này không tự hoạt động 1 cách riêng lẽ, "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"value"}]},{type:"text",value:" trả về ở đây sẽ được truyền vào 1 hàm lifecycle khác là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"text",value:", sẽ được mình trình bày bên dưới. Tạm gác vấn đề "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" list ở đây để xem "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"text",value:" là cái khỉ gì đã nhé."}]},{type:"text",value:"\n"},{type:"element",tagName:"h4",properties:{},children:[{type:"text",value:"5. componentDidUpdate()"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Như đã tiết lộ, hàm này sẽ được gọi sau "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:". Và tham số của nó cũng giống như "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Chú lại xạo lol anh rồi, bên trên đã nói "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"value"}]},{type:"text",value:" từ "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" được truyền xún hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"text",value:" rồi còn gì. À đó là trường hợp phổ biến, còn nếu bạn dùng chung với "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" thì có thêm tham số thứ ba (snapshot), chính là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"value"}]},{type:"text",value:" được truyền đến:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" snapshot"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Đi vào giải quyết vấn đề thôi :smiley: Thêm code sau vào "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"App"}]},{type:"text",value:" component:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"state"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" chatThreadRef "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"current"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollHeight "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollTop"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"null"}]},{type:"element",tagName:"span",
properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\n"},{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" snapshot"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"snapshot "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"!=="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"null"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" chatThreadRef "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"current"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t\tchatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollTop "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollHeight "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" snapshot"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Code dell hiểu cái quần què gì cả, giải thích xem nào:"}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Mình có sử dùng "},{type:"element",tagName:"strong",properties:{},children:[{type:"text",value:"React Ref"}]},{type:"text",value:" để xử lý với DOM, bạn có thể tìm hiểu tại "},{type:"element",tagName:"a",properties:{href:"https://reactjs.org/docs/refs-and-the-dom.html"},children:[{type:"text",value:"đây"}]},{type:"text",value:". Ở đây, DOM element mình muốn xử lý là thẻ "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"ul"}]},{type:"text",value:" bao bọc "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" list component:"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"text",value:"ul className"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","string"]},children:[{type:"text",value:'"chat-thread"'}]},{type:"text",value:" ref"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:"   "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"..."}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"<"}]},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"/"}]},{type:"text",value:"ul"},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Mình chỉ muốn scroll khi có tin nhắn mới chứ không phải lúc nào cũng vậy, thế nên phải thêm điều kiện để kiểm tra có tin nhắn mới hay không?"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"state"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// write logic here"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Nếu có tin nhắn mới, "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" sẽ trả về một "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"value"}]},{type:"text",value:" nào đó. Không thì trả về "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"null"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"state"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:">"}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatList"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"length"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","comment"]},children:[{type:"text",value:"// write logic here"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"return"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"null"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hình bên dưới mô tả về "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"scrollTop"}]},{type:"text",value:" và "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"scrollHeight"}]},{type:"text",value:" được dùng để tính toán cho scroll."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*iSwbToUuE4Cj1cE_s1Jf6A.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Ban đầu, "},{type:"element",tagName:"a",properties:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollHeight"},children:[{type:"text",value:"scrollHeight"}]},{type:"text",value:"  sẽ là chiều cao của "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"Chats"}]},{type:"text",value:" panel — trước khi tin nhắn mới được thêm vào DOM, scrollTop sẽ = 0, và giá trị trả về của hàm "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"getSnapshotBeforeUpdate"}]},{type:"text",value:" sẽ là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"chatThreadRef.scrollHeight - 0"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Giá trị này sẽ được chuyển đến "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"text",value:":"}]},{type:"text",value:"\n"},{type:"element",tagName:"div",properties:{className:["gatsby-highlight"],dataLanguage:"js"},children:[{type:"text",value:"\n      "},{type:"element",tagName:"pre",properties:{className:["language-js"]},children:[{type:"element",tagName:"code",properties:{className:["language-js"]},children:[{type:"element",tagName:"span",properties:{className:["token","function"]},children:[{type:"text",value:"componentDidUpdate"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"element",tagName:"span",properties:{className:["token","parameter"]},children:[{type:"text",value:"prevProps"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" prevState"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:","}]},{type:"text",value:" snapshot"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"if"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"("}]},{type:"text",value:"snapshot "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"!=="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"null"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:")"}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"{"}]},{type:"text",value:"\n\t\t"},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"const"}]},{type:"text",value:" chatThreadRef "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" "},{type:"element",tagName:"span",properties:{className:["token","keyword"]},children:[{type:"text",value:"this"}]},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"current"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t\tchatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollTop "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"="}]},{type:"text",value:" chatThreadRef"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"."}]},{type:"text",value:"scrollHeight "},{type:"element",tagName:"span",properties:{className:["token","operator"]},children:[{type:"text",value:"-"}]},{type:"text",value:" snapshot"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:";"}]},{type:"text",value:"\n\t"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]},{type:"text",value:"\n"},{type:"element",tagName:"span",properties:{className:["token","punctuation"]},children:[{type:"text",value:"}"}]}]}]},{type:"text",value:"\n      "}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Chúng ta sẽ tính toán lại "},{type:"element",tagName:"a",properties:{href:"https://developer.mozilla.org/en-US/docs/Web/API/Element/scrollTop"},children:[{type:"text",value:"scrollTop"}]},{type:"text",value:", dựa theo giá trị truyền vào: "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"chatThreadRef.scrollHeight - snapshot;"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Hãy nhìn hình dưới đây để dể hình dung, giá trị "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"snapshot"}]},{type:"text",value:" chính là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"scrollHeight"}]},{type:"text",value:" trước khi DOM updated (previous scrollHeight), còn "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"chatThreadRef.scollHeight"}]},{type:"text",value:" chính là "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"scrollHeight"}]},{type:"text",value:" sau khi DOM updated (updated scrollHeight), vì thế khoảng cách (difference) chính là giá trị chúng ta cần scroll."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*8uQmkLjLXpzbZQN8JJ71UQ.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Set lại "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"scrollTop"}]},{type:"text",value:" theo "},{type:"element",tagName:"code",properties:{className:["language-text"]},children:[{type:"text",value:"difference"}]},{type:"text",value:"."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*k2dioTIozf78at5G_G4_jg.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Và những gì chúng ta mong đợi."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"element",tagName:"img",properties:{src:"https://cdn-images-1.medium.com/max/800/1*3DDset-1uLpUeQfvALluZQ.png"},children:[]}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Nếu vẫn còn chưa hiểu thì bạn hãy comment bên dưới nhé. Phần 2 chắc phải dừng lại ở đây. Đón xem phần 3 cũng là phần cuối ở vài viết sau nhé. Chúng ta sẽ tìm hiểu về 2 quá trình còn lại của React component."}]},{type:"text",value:"\n"},{type:"element",tagName:"p",properties:{},children:[{type:"text",value:"Chào thân ái và quyết thắng!"}]}],data:{quirksMode:!1}},fields:{slug:"/react-component-lifecycle-2/",prefix:"2019-05-26"},frontmatter:{title:"Tìm hiểu vòng đời của React 16+ component (Phần 2)",subTitle:"React16+ component lifecycle",cover:{childImageSharp:{resize:{src:"/blog/static/cover-89c62343529c8b1216ffcece50350ad7-ada8c.jpg"}}}}},author:{id:"/media/duthaho/New Volume/learn/github/duthaho-blog/content/parts/author.md absPath of file >>> MarkdownRemark",html:"<p>Mình là một thằng đầu to, trán hói, chuẩn loser vozer, cao chỉ 1m55 nhưng nặng đến gần 60kg :laughing:. Có tập Gym nên bụng 6 múi và nhiều gái khen đẹp zai. Mục tiêu của blog này chủ yếu là để dành đọc lại lúc cần, cũng để cho mọi người vào đọc giết thời gian cho vui :kissing:.</p>"},footnote:{id:"/media/duthaho/New Volume/learn/github/duthaho-blog/content/parts/footnote.md absPath of file >>> MarkdownRemark",html:'<ul>\n<li><a href="https://duthaho.github.io/" target="_blank">my resume</a> - <a href="https://www.buymeacoffee.com/lp1cMOE" target="_blank">buy a coffee</a> - <a href="http://eepurl.com/gsE-Kr" target="_blank">email register</a></li>\n</ul>'},site:{siteMetadata:{facebook:{appId:"1476613389154628"}}}},pathContext:{slug:"/react-component-lifecycle-2/"}}}});
//# sourceMappingURL=path---react-component-lifecycle-2-473b3eaecbd62a072c3a.js.map